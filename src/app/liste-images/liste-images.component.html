<app-header></app-header>

<div class="container">
  <button (click)="toggleDisplayMode()">Changer de mode</button>
  <!-- Ajoutez ce bouton pour déclencher la suppression des images sélectionnées -->
  <button class="buttonDelete" (click)="onDeleteSelected()">Supprimer</button>
  <button class="buttonDownload" (click)="onDownloadSelected()">Télécharger</button>
</div>

<div *ngIf="displayMode === 'table'">
  <table>
    <thead>
      <tr>
        <th>Nom</th>
        <th>Description</th>
        <th>URL</th>
        <th>Tags / Confidence</th>
        <th>Date de création</th>
        <th>Sélection</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let image of images">
        <tr>
          <td>{{ image.name }}</td>
          <td>{{ image.description }}</td>
          <td>
            <a href="{{ image.url }}" target="_blank" (mouseover)="showPreview($event, image.url)" (mousemove)="movePreview($event)" (mouseout)="hidePreview()">{{ image.url }}</a>
            <img #imagePreview class="image-preview" src="{{ previewImageUrl }}" alt="Aperçu de l'image">
          </td>
          
          <td>
            <span *ngFor="let tag of image.tags">
              {{ tag.name }} : {{ (tag.confidence * 100).toFixed(2) }}%,
            </span>
          </td>
          <td>{{ image.created_at }}</td>
          <!-- Ajoutez cette case à cocher liée à la propriété 'selected' de l'image -->
          <td><input type="checkbox" [(ngModel)]="image.selected"></td>
        </tr>
      </ng-container>
    </tbody>
  </table>
</div>

<div *ngIf="displayMode === 'gallery'">
  <select [(ngModel)]="numberOfColumns" (change)="changeNumberOfColumns(numberOfColumns)">
    <option value="1">1 colonne</option>
    <option value="2">2 colonnes</option>
    <option value="3">3 colonnes</option>
    <option value="4">4 colonnes</option>
    <option value="5">5 colonnes</option>
    <!-- ajoutez plus d'options si nécessaire -->
  </select>
  <div class="container">
    <div class="image-gallery" [ngStyle]="{'grid-template-columns': 'repeat(' + numberOfColumns + ', 1fr)'}">
      <div class="image-card" *ngFor="let image of images">
        <h3>{{ image.name }}</h3>
        <!-- Ajoutez cette case à cocher avant l'image -->
        <img src="{{ image.url }}" alt="{{ image.name }}"> 
        <h4 class="description">Description: <p>{{ image.description }}</h4>
        <h4>Tags: <p>
          <span *ngFor="let tag of image.tags">
            {{ tag.name }} : {{ (tag.confidence * 100).toFixed(2) }}%,
          </span>
        </p></h4>
        
        <p>{{ image.created_at }}</p>

        <input type="checkbox" [(ngModel)]="image.selected">
      </div>
    </div>
  </div>
</div>
